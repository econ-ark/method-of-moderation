% Created with jtex v.1.0.20
\documentclass[twocolumn, switch]{article}
\usepackage{preprint}
\usepackage{hyperref}
\usepackage[numbers,square]{natbib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%  imports  %%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{graphicx}
%%%%%%%%%%%%%%%%%  math commands  %%%%%%%%%%%%%%%%
\newcommand{\mNrm}{m}
\newcommand{\CRRA}{\rho}
\newcommand{\cNrm}{c}
\newcommand{\uFunc}{\mathbf{u}}
\newcommand{\Ex}{\mathbf{\mathbb{E}}}
\newcommand{\DiscFac}{\beta}
\newcommand{\cLvl}{\mathbf{c}}
\newcommand{\aLvl}{\mathbf{a}}
\newcommand{\mLvl}{\mathbf{m}}
\newcommand{\PermGroShk}{\mathcal{G}}
\newcommand{\pLvl}{\mathbf{p}}
\newcommand{\tranShk}{\xi}
\newcommand{\yLvl}{\mathbf{y}}
\newcommand{\Rfree}{\text{R}}
\newcommand{\PermGroFac}{G}
\newcommand{\permShk}{\psi}
\newcommand{\permShkMin}{\underline{\permShk}}
\newcommand{\permShkMax}{\bar{\permShk}}
\newcommand{\WorstProb}{\wp}
\newcommand{\tranShkEmp}{\theta}
\newcommand{\vFunc}{\mathbf{v}}
\newcommand{\uPrime}{\uFunc'}
\newcommand{\AbsPatFac}{\Phi}
\newcommand{\hNrm}{h}
\newcommand{\hNrmOpt}{\bar{\hNrm}}
\newcommand{\cFunc}{\mathbf{c}}
\newcommand{\cFuncOpt}{\bar{\cFunc}}
\newcommand{\MPC}{\boldsymbol{\kappa}}
\newcommand{\MPCmin}{\underline{\MPC}}
\newcommand{\hNrmPes}{\underline{\hNrm}}
\newcommand{\tranShkMin}{\underline{\tranShk}}
\newcommand{\mNrmMin}{\underline{\mNrm}}
\newcommand{\logmNrmEx}{\boldsymbol{\mu}}
\newcommand{\modRte}{\boldsymbol{\omega}}
\newcommand{\mNrmEx}{\Delta \mNrm}
\newcommand{\hNrmEx}{\Delta \hNrm}
\newcommand{\cFuncPes}{\underline{\cFunc}}
\newcommand{\cFuncApprox}{\grave{\cFunc}}
\newcommand{\cFuncReal}{\hat{\cFunc}}
\newcommand{\logitModRte}{\boldsymbol{\chi}}
\newcommand{\asympSlope}{\alpha}
\newcommand{\logitModRteApprox}{\grave{\logitModRte}}
\newcommand{\MPCmax}{\bar{\MPC}}
\newcommand{\mNrmCusp}{\mNrm^*}
\newcommand{\modRteLoTightUpBd}{\grave{\check{\modRte}}}
\newcommand{\vFuncOpt}{\bar{\vFunc}}
\newcommand{\vInv}{{\scriptsize \boldsymbol{\Lambda}}}
\newcommand{\vInvOpt}{\bar{\vInv}}
\newcommand{\valModRte}{\boldsymbol{\Omega}}
\newcommand{\valModRteReal}{\hat{\valModRte}}
\newcommand{\logitValModRteReal}{\hat{\boldsymbol{X}}}
\newcommand{\vFuncReal}{\hat{\vFunc}}
\newcommand{\vInvReal}{\hat{\vInv}}
\newcommand{\MPCmod}{\boldsymbol{\eta}}
\newcommand{\modRteMu}{\partial \modRte / \partial \logmNrmEx}
\newcommand{\logitModRteMu}{\partial \logitModRte / \partial \logmNrmEx}
\newcommand{\Nrml}{\mathcal{N}}
\newcommand{\std}{\sigma}
\newcommand{\risky}{\mathbf{r}}
\newcommand{\Risky}{\mathbf{R}}
\newcommand{\equityPrem}{\pi}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% colors for hyperlinks
\hypersetup{colorlinks=true, linkcolor=purple, urlcolor=blue, citecolor=cyan, anchorcolor=black}

\usepackage[utf8]{inputenc}	% allow utf-8 input
\usepackage[T1]{fontenc}
\usepackage{xcolor}
\usepackage{lineno}					% Line numbers
\usepackage{tikz} 					% ORCiD insertion

%% Bibliography options
\bibliographystyle{unsrtnat}

 %% Special figure caption options
\usepackage{newfloat}
\DeclareFloatingEnvironment[name={Supplementary Figure}]{suppfigure}
\usepackage{sidecap}
\sidecaptionvpos{figure}{c}

% Section title spacing  options
\usepackage{titlesec}
\titlespacing\section{0pt}{12pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}
\titlespacing\subsection{0pt}{10pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}
\titlespacing\subsubsection{0pt}{8pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}

\definecolor{lime}{HTML}{A6CE39}
\DeclareRobustCommand{\orcidicon}{
	\begin{tikzpicture}
	\draw[lime, fill=lime] (0,0)
	circle [radius=0.16]
	node[white] {{\fontfamily{qag}\selectfont \tiny ID}};
	\draw[white, fill=white] (-0.0625,0.095)
	circle [radius=0.007];
	\end{tikzpicture}
	\hspace{-2mm}
}

%%%%%%%%%%%%%%%%   Title   %%%%%%%%%%%%%%%%
\title{Introduction}

% Add watermark with submission status
% Awaiting watermark support
% \usepackage{xwatermark}
% % Left watermark
% \newwatermark[firstpage,color=gray!60,angle=90,scale=0.32, xpos=-4.05in,ypos=0]{\href{https://doi.org/}{\color{gray}{Publication doi}}}
% % Right watermark
% \newwatermark[firstpage,color=gray!60,angle=90,scale=0.32, xpos=3.9in,ypos=0]{\href{https://doi.org/}{\color{gray}{Preprint doi}}}
% % Bottom watermark
% \newwatermark[firstpage,color=gray!90,angle=0,scale=0.28, xpos=0in,ypos=-5in]{*correspondence: \texttt{}}

%%%%%%%%%%%%%%%  Author list  %%%%%%%%%%%%%%%
\usepackage{authblk}
\renewcommand*{\Authfont}{\bfseries}

\author[1, 2\thanks{\texttt{ccarroll@jhu.edu}}]{Christopher D. Carroll\href{https://orcid.org/0000-0003-3732-9312}{\orcidicon}}
\author[1, 2\thanks{\texttt{alujan@jhu.edu}}]{Alan Lujan\href{https://orcid.org/0000-0002-5289-7054}{\orcidicon}}
\author[3]{Karsten Chipeniuk}
\author[4]{Kiichi Tokuoka}
\author[5]{Weifeng Wu}
\affil[1]{Johns Hopkins University}
\affil[2]{Econ-ARK}
\affil[3]{Reserve Bank of New Zealand}
\affil[4]{Japanese Ministry of Finance}
\affil[5]{Fannie Mae}

%%%%%%%%%%%%%%    Front matter    %%%%%%%%%%%%%%
\begin{document}

\twocolumn[\begin{@twocolumnfalse}

\maketitle

\begin{abstract}
In a risky world, a pessimist assumes the worst will happen. Someone who ignores risk altogether is an optimist. Consumption decisions are mathematically simple for both the pessimist and the optimist because both behave as if they live in a riskless world. A consumer who is a realist (that is, who wants to respond optimally to risk) faces a much more difficult problem, but (under standard conditions) will choose a level of spending somewhere between that of the pessimist and the optimist. We use this fact to redefine the space in which the realist searches for optimal consumption rules. The resulting solution accurately represents the numerical consumption rule over the entire interval of feasible wealth values with remarkably few computations.\\
\end{abstract}

\keywords{Dynamic Stochastic Optimization, Consumption-Saving Models, Numerical Methods}

\vspace{0.5cm}

\end{@twocolumnfalse}]

%%%%%%%%%%%%%%%  Main text   %%%%%%%%%%%%%%%

Solving a consumption-saving problem using numerical methods requires the modeler to choose how to represent a policy function. In the stochastic case, where analytical solutions are generally not available, a common approach is to use low-order polynomial splines that exactly match the function at a finite set of gridpoints, and then to assume that interpolated or extrapolated versions of that spline represent the function well at the continuous infinity of unmatched points. \citet{carrollEGM} developed the endogenous gridpoints method, which has become a standard tool for computing consumption at gridpoints determined endogenously using the Euler equation.

Unfortunately, this endogenous gridpoints solution is not very well-behaved outside the original range of gridpoints (though other common solution methods are no better outside their own predefined ranges). Figure~\ref{fig:ExtrapProblem} demonstrates the point: in the presence of uncertainty, the consumption rule must be evaluated outside \textit{any} prespecified grid, because large shock realizations push next period's assets beyond the grid boundaries. Although theory proves that precautionary saving is always positive, the linearly extrapolated numerical approximation eventually predicts negative precautionary saving.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/9d4f7989eda5d34a0040765014e40698.png}
\caption[]{For Large Enough $\mNrm_{T -1}$, Predicted Precautionary Saving is Negative (Oops!)}
\label{fig:ExtrapProblem}
\end{figure}

This error cannot be fixed by extending the upper gridpoint. While extrapolation techniques can prevent this from being fatal, the problem is often dealt with using inelegant methods whose implications for accuracy are difficult to gauge.

This paper argues that, in the standard consumption problem, a better approach is to rely upon the fact that without uncertainty, the optimal consumption function has a simple analytical solution. The key insight is that, under standard assumptions, the consumer who faces an uninsurable labor income risk will consume less than a consumer with the same path for expected income but who does not perceive any uncertainty. Following \citet{Leland1968}, \citet{Sandmo1970}, and \citet{Kimball1990}, the `realistic' consumer, who \textit{does} perceive the risks, will engage in `precautionary saving,' so the perfect foresight riskless solution provides an upper bound to the solution that will actually be optimal. A lower bound is provided by the behavior of a consumer who has the subjective belief that the future level of income will be the worst that it can possibly be. This consumer, too, behaves according to the convenient analytical perfect foresight solution, but his certainty is that of a pessimist perfectly confident in his pessimism.

We build on bounds for the consumption function and limiting MPCs established by \citet{StachurskiToda2019JET}, \citet{MST2020JET}, \citet{Carroll2001MPCBound}, and \citet{MaToda2021SavingRateRich} in buffer-stock theory. Using results from \citet{CarrollShanker2024}, we show how to use these bounds to constrain the shape and characteristics of the solution to the `realist' problem characterized by \citet{Carroll1997}. Imposition of these constraints clarifies and speeds the solution of the realist's problem. For comparison, we use the endogenous gridpoints method \citep{carrollEGM} as our benchmark, which computes consumption at gridpoints determined endogenously using the Euler equation.

After showing how to use the method in the baseline case, we show how to refine it to encompass an even tighter theoretical bound, and how to extend it to solve a problem in which the consumer faces both labor income risk and rate-of-return risk.

\section{The Realist's Problem}

Consider a consumer who correctly perceives all risks. The consumer has CRRA utility with risk aversion parameter $\CRRA > 0$:

\begin{equation}
\label{eq:UtilityFunc}
\uFunc(\cNrm) = \begin{cases}
\frac{\cNrm^{1-\CRRA}}{1-\CRRA} & \text{if } \CRRA \neq 1 \\
\log \cNrm & \text{if } \CRRA = 1.
\end{cases}
\end{equation}

This utility function satisfies prudence ($\uFunc''' > 0$), which induces precautionary saving. The consumer maximizes expected lifetime utility:

\begin{equation}
\label{eq:MaxProb}
\max~\Ex_{t}\left[\sum_{n=0}^{T-t}\DiscFac^{n} \uFunc(\cLvl_{t+n})\right]
\end{equation}

subject to $\aLvl_{t} = \mLvl_{t} -\cLvl_{t}$, $\pLvl_{t+1} = \pLvl_{t} \PermGroShk_{t+1}$, $\yLvl_{t+1} = \pLvl_{t+1}\tranShk_{t+1}$, $\mLvl_{t+1} = \aLvl_{t}\Rfree_{t+1} + \yLvl_{t+1}$, where $\mLvl$ denotes market resources, $\pLvl$ permanent labor income, $\aLvl$ assets, and $\yLvl$ noncapital income. Income evolves via the Friedman-Muth process (\citet{Friedman1957} distinguished permanent from transitory income; \citet{Muth1960} provided the stochastic framework): $\PermGroShk_{t+1} = \PermGroFac_{t+1} \permShk_{t+1}$ with permanent shocks $\permShk$ having mean unity and bounded support $[\permShkMin, \permShkMax]$ where $0 < \permShkMin \leq 1 \leq \permShkMax < \infty$, and transitory shocks $\tranShk_{t+1}$ taking value 0 with probability $\WorstProb > 0$ (unemployment) or $\tranShkEmp_{t+1}/(1 -\WorstProb)$ otherwise, with $\Ex[\tranShkEmp]=1$.

This problem can be rewritten (see \citet{SolvingMicroDSOPs} for a proof) in a more convenient form in which choice and state variables are normalized by the level of permanent income, e.g., $\mNrm=\mLvl/\pLvl$. When that is done, the Bellman equation for the transformed version of the consumer's problem is

\begin{equation}
\label{eq:vNormed}
\vFunc_{t}(\mNrm_{t}) = \max_{\cNrm_{t}} ~~ \uFunc(\cNrm_{t})+\DiscFac \Ex_{t}[ \PermGroShk_{t+1}^{1-\CRRA}\vFunc_{t+1}(\mNrm_{t+1})]
\end{equation}

with Euler equation $\uPrime(\cNrm_{t}) = \DiscFac \Rfree \Ex_{t}[ \PermGroShk_{t+1}^{ -\CRRA} \uPrime(\cNrm_{t+1})]$.

For expositional simplicity, we assume $\CRRA \neq 1$ and set $\PermGroFac=1$, $\permShk=1$ (no permanent income growth or shocks), working with the infinite-horizon formulation; results extend to general cases. Parameter restrictions (below) are required.

We define the absolute patience factor $\AbsPatFac\equiv(\DiscFac\Rfree)^{1/\CRRA}$. \citet{CarrollShanker2024} shows that a finite solution requires: (i) finite-value-of-autarky condition (FVAC) $0<\DiscFac\PermGroFac^{1 -\CRRA}\Ex[\permShk^{1 -\CRRA}]<1$, (ii) absolute-impatience condition (AIC) $\AbsPatFac<1$, (iii) return-impatience condition (RIC) $\AbsPatFac/\Rfree<1$, (iv) growth-impatience condition (GIC) $\AbsPatFac/\PermGroFac<1$, and (v) finite-human-wealth condition (FHWC) $\PermGroFac/\Rfree<1$. These patience conditions ensure the consumption bounds and limiting MPCs used in our method.

\section{The Method of Moderation}

\subsection{The Optimist, the Pessimist, and the Realist}

As a preliminary to our solution, define $\hNrmOpt$\footnote{Setting $\tranShk_{t+n}=1$ (the optimist's assumption), human wealth in infinite-horizon is $\hNrmOpt = \PermGroFac/(\Rfree -\PermGroFac)$ if $\Rfree>\PermGroFac$. When $\PermGroFac=1$, $\hNrmOpt = 1/(\Rfree -1)$.} as end-of-period human wealth (the present discounted value of future labor income) for a perfect foresight version of the problem of a `risk optimist:' a consumer who believes with perfect confidence that the shocks will always take their expected value of 1, $\tranShk_{t+n} = \Ex[\tranShk]=1~\forall~n>0$. The solution to a perfect foresight problem of this kind takes the form

\begin{equation}
\label{eq:cFuncOpt}
\cFuncOpt(\mNrm) = (\mNrm + \hNrmOpt)\MPCmin
\end{equation}

for a constant minimal marginal propensity to consume $\MPCmin$.\footnote{The MPC of the perfect foresight consumer: infinite-horizon $\MPCmin=1 -\AbsPatFac/\Rfree$.} We similarly define $\hNrmPes$\footnote{Setting $\tranShk_{t+n}=\tranShkMin~\forall~n>0$, minimal human wealth is $\hNrmPes=\tranShkMin\PermGroFac/(\Rfree -\PermGroFac)$ if $\Rfree>\PermGroFac$. When $\tranShkMin=0$, $\hNrmPes=0$.} as `minimal human wealth,' the present discounted value of labor income if the shocks were to take on their worst value in every future period $\tranShk_{t+n} = \tranShkMin$ $\forall~n>0$ (which we define as corresponding to the beliefs of a `pessimist'). We will call a `realist' the consumer who correctly perceives the true probabilities of the future risks and optimizes accordingly.

A first useful point is that, for the realist, a lower bound for the level of market resources is the natural borrowing constraint $\mNrmMin = -\hNrmPes$ derived by \citet{Aiyagari1994} and \citet{Huggett1993}, because if $\mNrm$ equalled this value then there would be a positive finite chance (however small) of receiving $\tranShk_{t+n} = \tranShkMin$ in every future period, which would require the consumer to set $\cNrm$ to zero in order to guarantee that the intertemporal budget constraint holds. Since consumption of zero yields negative infinite utility, \citet{Zeldes1989} and \citet{Deaton1991} show that the solution to the realist consumer's problem is not well defined for values of $\mNrm < \mNrmMin$, and the limiting value of the realist's $\cNrm$ is zero as $\mNrm \downarrow \mNrmMin$, where $\modRte(\logmNrmEx) \to 0$ as $\logmNrmEx \to -\infty$ (established in \citet{CarrollShanker2024}).

It is convenient to define `excess' market resources as the amount by which actual resources exceed the lower bound, and `excess' human wealth as the amount by which mean expected human wealth exceeds guaranteed minimum human wealth:

\begin{equation}
\label{eq:ExcessDef}
\begin{aligned}
\mNrmEx &= \mNrm+\overbrace{\hNrmPes}^{=-\mNrmMin} \\
\hNrmEx &= \hNrmOpt-\hNrmPes.
\end{aligned}
\end{equation}

We now define the optimal consumption rules for the two perfect foresight problems. The `pessimist' perceives human wealth to be equal to its minimum feasible value $\hNrmPes$ with certainty, so consumption is given by the perfect foresight solution

\begin{equation}
\label{eq:cFuncPes}
\cFuncPes(\mNrm) = (\mNrm+\hNrmPes)\MPCmin = \mNrmEx\MPCmin.
\end{equation}

The `optimist,' on the other hand, pretends that there is no uncertainty about future income, and therefore consumes

\begin{equation}
\label{eq:cFuncOptExcess}
\cFuncOpt(\mNrm) = (\mNrmEx + \hNrmEx)\MPCmin = \cFuncPes(\mNrm)+\hNrmEx \MPCmin.
\end{equation}

\subsection{The Moderation Ratio}

It seems obvious that the spending of the realist will be strictly greater than that of the pessimist and strictly less than that of the optimist.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/a309120ddc133b3d7048b585cff5da3f.png}
\caption[]{Moderation Illustrated: $\cFuncPes < \cFuncApprox < \cFuncOpt$}
\label{fig:IntExpFOCInvPesReaOptNeedHi}
\end{figure}

The proof is more difficult than might be imagined, but the necessary work is done in \citet{CarrollShanker2024} so we will take the proposition as a fact and proceed by manipulating the inequality:

\begin{equation}
\begin{array}{rcl}
\cFuncOpt(\mNrmMin+\mNrmEx) > & \cFuncReal(\mNrmMin+\mNrmEx) & > \cFuncPes(\mNrmMin+\mNrmEx) \\
-\cFuncOpt(\mNrmMin+\mNrmEx) < & -\cFuncReal(\mNrmMin+\mNrmEx) & < -\cFuncPes(\mNrmMin+\mNrmEx) \\
0 < & \cFuncReal(\mNrmMin+\mNrmEx)-\cFuncPes(\mNrmMin+\mNrmEx) & < \hNrmEx \MPCmin \\
0 < & \underbrace{\left(\frac{\cFuncReal(\mNrmMin+\mNrmEx)-\cFuncPes(\mNrmMin+\mNrmEx)}{\hNrmEx \MPCmin}\right)}_{\equiv \modRte} & < 1
\end{array}
\end{equation}

where the fraction in the middle of the last inequality is the moderation ratio measuring how close the realist's consumption is to the optimist's behavior (the numerator is the gap between the realist and pessimist) relative to the maximum possible gap between optimist and pessimist. When $\modRte=0$, the realist behaves like the pessimist (maximum precautionary saving); when $\modRte=1$, the realist behaves like the optimist (no precautionary saving). \citet{CarrollKimball1996} and \citet{CarrollShanker2024} establish that under bounded shocks, $\modRte\in(0,1)$ strictly for all $\mNrm > \mNrmMin$. Defining $\logmNrmEx = \log \mNrmEx$ (which can range from $-\infty$ to $\infty$), the object in the middle of the last inequality is

\begin{equation}
\label{eq:modRte}
\modRte(\logmNrmEx) \equiv  \left(\frac{\cFuncReal(\mNrmMin+e^{\logmNrmEx})-\cFuncPes(\mNrmMin+e^{\logmNrmEx})}{\hNrmEx \MPCmin}\right),
\end{equation}

and we now define

\begin{equation}
\label{eq:chi}
\begin{aligned}
\logitModRte(\logmNrmEx) &= \log \left(\frac{\modRte(\logmNrmEx)}{1-\modRte(\logmNrmEx)}\right) \\
&= \log(\modRte(\logmNrmEx)) - \log(1-\modRte(\logmNrmEx))
\end{aligned}
\end{equation}

which has the virtue that it is \textit{asymptotically linear} in the limit as $\logmNrmEx$ approaches $+\infty$.\footnote{Under the GIC, $\logitModRte(\logmNrmEx)$ is asymptotically linear with slope $\asympSlope \geq 0$ as $\logmNrmEx \to +\infty$. We extrapolate $\logitModRte$ linearly using the boundary slope, preserving $\modRte\in(0,1)$ and hence $\cFuncPes < \cFuncApprox < \cFuncOpt$ throughout the extrapolation domain.} The method uses standard transformations for unbounded domains: logit maps $\modRte \in (0,1)$ to $\logitModRte \in ( -\infty, \infty)$ with inverse sigmoid $\modRte = 1/(1+\exp( -\logitModRte))$; log maps $(\mNrm - \mNrmMin) \in (0, \infty)$ to $\logmNrmEx \in ( -\infty, \infty)$. As $\modRte \to 1$ (realist approaches optimist), $\logitModRte \to +\infty$; as $\modRte \to 0$ (realist approaches pessimist), $\logitModRte \to -\infty$.

Given $\logitModRte$, the consumption function can be recovered from

\begin{equation}
\label{eq:cFuncHi}
\cFuncReal = \cFuncPes+\overbrace{\frac{1}{1+\exp(-\logitModRte)}}^{=\modRte} \hNrmEx \MPCmin.
\end{equation}

Thus, the procedure is to calculate $\logitModRte$ at the points $\logmNrmEx$ corresponding to the log of the $\mNrmEx$ points defined above, and then using these to construct an interpolating approximation $\logitModRteApprox$ from which we indirectly obtain our approximated consumption rule $\cFuncApprox$ (an approximation to the true $\cFuncReal$) by substituting $\logitModRteApprox$ for $\logitModRte$ in equation (\ref{eq:cFuncHi}).

Because this method relies upon the fact that the problem is easy to solve if the decision maker has unreasonable views (either in the optimistic or the pessimistic direction), and because the correct solution is always between these immoderate extremes, we call our solution procedure the `method of moderation.'

Results are shown in Figure~\ref{fig:ExtrapProblemSolved}; a reader with very good eyesight might be able to detect the barest hint of a discrepancy between the Truth and the Approximation at the far righthand edge of the figure, a stark contrast with the calamitous divergence evident in Figure~\ref{fig:ExtrapProblem}.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/d62ef7e2065a99cef624e7261a86f76d.png}
\caption[]{Extrapolated $\cFuncApprox_{T -1}$ Constructed Using the Method of Moderation}
\label{fig:ExtrapProblemSolved}
\end{figure}

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/fc457085e346a73d82774274b956cd2d.png}
\caption[]{EGM vs MoM: Identical Sparse Grids, Different Extrapolation Behavior}
\label{fig:DirectComparison}
\end{figure}

\section{Extensions}

\subsection{A Tighter Upper Bound}

\citet{CarrollShanker2024} derives an explicit formula for the MPC at the natural borrowing constraint: $\MPCmax = 1 - \WorstProb^{1/\CRRA} (\AbsPatFac/\Rfree)$ where $\WorstProb$ is the unemployment probability derived by \citet{CarrollToche2009}. This provides a tighter upper bound near the constraint, extending the explicit limiting MPC formulas established in buffer-stock theory by \citet{MaToda2021SavingRateRich}. Strict concavity of the consumption function implies $\cFuncReal(\mNrm) < \MPCmax \mNrmEx$ for low wealth, while the optimist's bound $\cFuncReal(\mNrm) < \cFuncOpt(\mNrm) = (\mNrmEx+\hNrmEx)\MPCmin$ is tighter for high wealth.

The two upper bounds intersect at the cusp point:

\begin{equation}
\label{eq:mNrmCusp}
\mNrmCusp = -\hNrmPes + \frac{\MPCmin(\hNrmOpt-\hNrmPes)}{\MPCmax-\MPCmin}
\end{equation}

This intersection occurs in the feasible region since $\MPCmax > \MPCmin$ under the stated conditions (the MPC is highest when wealth is lowest).

For $\mNrm < \mNrmCusp$, define the low-region moderation ratio using the tighter bound:

\begin{equation}
\label{eq:modRteLoTightUpBd}
\modRteLoTightUpBd(\logmNrmEx) = \frac{\cFuncReal(\mNrmMin+e^{\logmNrmEx})e^{-\logmNrmEx}-\MPCmin}{\MPCmax-\MPCmin}
\end{equation}

This ratio measures how far consumption per unit of wealth exceeds the optimist's MPC, relative to the maximum possible excess. Applying the logit transformation and interpolating as before yields consumption satisfying both upper bounds throughout.

For computational robustness, construct a three-piece approximation: below the cusp using the tight bound, near the cusp using Hermite interpolation matching levels and slopes at adjacent gridpoints, above the cusp using the original optimist bound. This ensures continuous, differentiable consumption functions respecting all theoretical constraints.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/a8b3d640b8a8b35394597a616e8d8ab0.png}
\caption[]{A Tighter Upper Bound}
\label{fig:IntExpFOCInvPesReaOptNeed45}
\end{figure}

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/39cd982237ccbe9795c6f267c8d2b19f.png}
\caption[]{Cusp Point: Intersection of Optimist and Tighter Upper Bounds}
\label{fig:CuspPoint}
\end{figure}

\subsection{Value Function}

Often it is useful to know the value function as well as the consumption rule. Fortunately, many of the tricks used when solving for the consumption rule have a direct analogue in approximation of the value function. Define the inverse value function transformation $\vInvOpt = ((1 -\CRRA)\vFuncOpt)^{1/(1 -\CRRA)}$, which under perfect foresight equals $(\mNrmEx+\hNrmEx)\MPCmin^{ -\CRRA/(1 -\CRRA)}$ (linear in market resources). The value moderation ratio $\valModRteReal$ measures proximity to the optimist's value, with logit transformation $\logitValModRteReal$ applied as before. Interpolate $\logitValModRteReal$ at gridpoints and invert to obtain $\vFuncReal = \uFunc(\vInvReal)$.

\subsection{Hermite Interpolation}

The numerical accuracy of the method of moderation depends critically on the quality of function approximation between gridpoints \citep{Santos2000}. Our bracketing approach complements work that bounds numerical errors in dynamic economic models \citep{JuddMaliarMaliar2017}. Although linear interpolation that matches the level of $\cFuncReal$ at the gridpoints is simple, Hermite interpolation \citep{Fritsch1980} offers a considerable advantage.

The moderation ratio derivative measures how quickly the realist approaches the optimist as resources increase:

\begin{equation}
\label{eq:modRteMu}
\frac{\partial \modRte}{\partial \logmNrmEx} = \frac{\mNrmEx (\partial \cFuncReal/\partial \mNrm - \MPCmin)}{\MPCmin \hNrmEx}.
\end{equation}

Differentiating (\ref{eq:cFuncHi}) with respect to $\mNrm$ yields a moderation form for the marginal propensity to consume:

\begin{equation}
\label{eq:MPCModeration}
\frac{\partial \cFuncReal}{\partial \mNrm} = (1-\MPCmod)\,\MPCmin + \MPCmod\,\MPCmax
\end{equation}

where

\begin{equation}
\label{eq:MPCModerationWeight}
\MPCmod = \frac{\MPCmin}{\MPCmax-\MPCmin} \cdot \frac{\hNrmEx}{\mNrmEx} \cdot \partial \modRte / \partial \logmNrmEx.
\end{equation}

Theory guarantees $\MPCmin \leq \partial \cFuncReal/\partial \mNrm \leq \MPCmax$ at gridpoints where the Euler equation holds. At very high wealth, $\MPCmod \to 0$ and the MPC approaches $\MPCmin$; near the borrowing constraint, $\MPCmod \to 1$ and the MPC approaches $\MPCmax$.

For Hermite interpolation, compute $\modRteMu$ at gridpoints, then derive $\logitModRteMu = \modRteMu/[\modRte(1 -\modRte)]$ for slope data. By matching both the level and the derivative of the $\cFuncReal$ function at the gridpoints, \citet{BenvenisteScheinkman1979} and \citet{MilgromSegal2002} show that the consumption rule derived from such interpolation numerically satisfies the Euler equation at each gridpoint for which the problem has been solved. These techniques extend naturally to the value function approximation.

\subsection{Stochastic Rate of Return}

For i.i.d. returns with $\log \Risky \sim \Nrml(r + \equityPrem - \std^{2}_{\risky}/2,\std^{2}_{\risky})$, \citet{Samuelson1969, Merton1969, Merton1971} showed that for a consumer without labor income (or with perfectly forecastable labor income) the consumption function is linear, with an MPC $= 1 - (\DiscFac \Ex[\Risky^{1 -\CRRA}])^{1/\CRRA}$. See \citet{CRRA-RateRisk, BBZ2016SkewedWealth} for extensions. Simply substitute this stochastic MPC for $\MPCmin$ throughout our formulas. The pessimist and optimist still perceive their income streams with certainty, but both face the same stochastic return; thus the Merton-Samuelson result applies to them and their consumption functions remain linear. The realist, however, faces both labor income uncertainty and rate-of-return risk, so the moderation ratio captures the combined precautionary response to both sources of uncertainty. All moderation ratio calculations proceed identically. Extensions to serially correlated returns require tracking the return state as an additional state variable, complicating the analysis but not fundamentally altering the approach.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/908dac8c8ea5ecd0d412feeb510e976b.png}
\caption[]{Effect of Return Uncertainty on Consumption Bounds}
\label{fig:StochasticBounds}
\end{figure}

\section{Conclusion}

The method proposed here is not universally applicable. For example, the method cannot be used for problems for which upper and lower bounds to the `true' solution are not known. But many problems do have obvious upper and lower bounds, and in those cases (as in the consumption example used in the paper), the method may result in substantial improvements in accuracy and stability of solutions.



%%%%%%%%%%%%%%   Bibliography   %%%%%%%%%%%%%%
\bibliography{main.bib}

\end{document}

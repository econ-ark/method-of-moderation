% Created with jtex v.1.0.20
\documentclass[twocolumn, switch]{article}
\usepackage{preprint}
\usepackage{hyperref}
\usepackage[numbers,square]{natbib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%  imports  %%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
%%%%%%%%%%%%%%%%%  math commands  %%%%%%%%%%%%%%%%
\newcommand{\Ex}{\mathbf{\mathbb{E}}}
\newcommand{\DiscFac}{\beta}
\newcommand{\CRRA}{\rho}
\newcommand{\PermGroFac}{G}
\newcommand{\permShk}{\psi}
\newcommand{\AbsPatFac}{\Phi}
\newcommand{\Rfree}{\text{R}}
\newcommand{\tranShk}{\xi}
\newcommand{\hNrm}{h}
\newcommand{\hNrmOpt}{\bar{\hNrm}}
\newcommand{\tranShkMin}{\underline{\tranShk}}
\newcommand{\hNrmPes}{\underline{\hNrm}}
\newcommand{\MPC}{\boldsymbol{\kappa}}
\newcommand{\MPCmin}{\underline{\MPC}}
\newcommand{\WorstProb}{\wp}
\newcommand{\MPCmax}{\bar{\MPC}}
\newcommand{\mNrm}{m}
\newcommand{\mNrmMin}{\underline{\mNrm}}
\newcommand{\hNrmEx}{\Delta \hNrm}
\newcommand{\logmNrmEx}{\boldsymbol{\mu}}
\newcommand{\cFunc}{\mathbf{c}}
\newcommand{\cFuncPes}{\underline{\cFunc}}
\newcommand{\cFuncReal}{\hat{\cFunc}}
\newcommand{\modRte}{\boldsymbol{\omega}}
\newcommand{\mNrmEx}{\Delta \mNrm}
\newcommand{\logitModRte}{\boldsymbol{\chi}}
\newcommand{\asympSlope}{\alpha}
\newcommand{\cFuncOpt}{\bar{\cFunc}}
\newcommand{\cFuncApprox}{\grave{\cFunc}}
\newcommand{\mNrmCusp}{\mNrm^*}
\newcommand{\mNrmCuspEx}{\Delta \mNrm^*}
\newcommand{\modRteLoTightUpBd}{\grave{\check{\modRte}}}
\newcommand{\cLvl}{\mathbf{c}}
\newcommand{\PDV}{\operatorname{PDV}}
\newcommand{\PDVCoverc}{\mathcal{C}}
\newcommand{\cNrm}{c}
\newcommand{\uFunc}{\mathbf{u}}
\newcommand{\vFunc}{\mathbf{v}}
\newcommand{\vFuncOpt}{\bar{\vFunc}}
\newcommand{\vInv}{{\scriptsize \boldsymbol{\Lambda}}}
\newcommand{\vInvOpt}{\bar{\vInv}}
\newcommand{\vFuncReal}{\hat{\vFunc}}
\newcommand{\vInvReal}{\hat{\vInv}}
\newcommand{\vInvPes}{\underline{\vInv}}
\newcommand{\valModRte}{\boldsymbol{\Omega}}
\newcommand{\valModRteReal}{\hat{\valModRte}}
\newcommand{\logitValModRteReal}{\hat{\boldsymbol{X}}}
\newcommand{\modRteMu}{\partial \modRte / \partial \logmNrmEx}
\newcommand{\MPCmod}{\boldsymbol{\eta}}
\newcommand{\Nrml}{\mathcal{N}}
\newcommand{\Risky}{\mathbf{R}}
\newcommand{\std}{\sigma}
\newcommand{\risky}{\mathbf{r}}
\newcommand{\equityPrem}{\pi}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% colors for hyperlinks
\hypersetup{colorlinks=true, linkcolor=purple, urlcolor=blue, citecolor=cyan, anchorcolor=black}

\usepackage[utf8]{inputenc}	% allow utf-8 input
\usepackage[T1]{fontenc}
\usepackage{xcolor}
\usepackage{lineno}					% Line numbers
\usepackage{tikz} 					% ORCiD insertion

%% Bibliography options
\bibliographystyle{unsrtnat}

 %% Special figure caption options
\usepackage{newfloat}
\DeclareFloatingEnvironment[name={Supplementary Figure}]{suppfigure}
\usepackage{sidecap}
\sidecaptionvpos{figure}{c}

% Section title spacing  options
\usepackage{titlesec}
\titlespacing\section{0pt}{12pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}
\titlespacing\subsection{0pt}{10pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}
\titlespacing\subsubsection{0pt}{8pt plus 3pt minus 3pt}{1pt plus 1pt minus 1pt}

\definecolor{lime}{HTML}{A6CE39}
\DeclareRobustCommand{\orcidicon}{
	\begin{tikzpicture}
	\draw[lime, fill=lime] (0,0)
	circle [radius=0.16]
	node[white] {{\fontfamily{qag}\selectfont \tiny ID}};
	\draw[white, fill=white] (-0.0625,0.095)
	circle [radius=0.007];
	\end{tikzpicture}
	\hspace{-2mm}
}

%%%%%%%%%%%%%%%%   Title   %%%%%%%%%%%%%%%%
\title{Appendix to "The Method of Moderation"}

% Add watermark with submission status
% Awaiting watermark support
% \usepackage{xwatermark}
% % Left watermark
% \newwatermark[firstpage,color=gray!60,angle=90,scale=0.32, xpos=-4.05in,ypos=0]{\href{https://doi.org/}{\color{gray}{Publication doi}}}
% % Right watermark
% \newwatermark[firstpage,color=gray!60,angle=90,scale=0.32, xpos=3.9in,ypos=0]{\href{https://doi.org/}{\color{gray}{Preprint doi}}}
% % Bottom watermark
% \newwatermark[firstpage,color=gray!90,angle=0,scale=0.28, xpos=0in,ypos=-5in]{*correspondence: \texttt{}}

%%%%%%%%%%%%%%%  Author list  %%%%%%%%%%%%%%%
\usepackage{authblk}
\renewcommand*{\Authfont}{\bfseries}

\author[1, 2\thanks{\texttt{ccarroll@jhu.edu}}]{Christopher D. Carroll\href{https://orcid.org/0000-0003-3732-9312}{\orcidicon}}
\author[1, 2\thanks{\texttt{alujan@jhu.edu}}]{Alan Lujan\href{https://orcid.org/0000-0002-5289-7054}{\orcidicon}}
\author[3]{Karsten Chipeniuk}
\author[4]{Kiichi Tokuoka}
\author[5]{Weifeng Wu}
\affil[1]{Johns Hopkins University}
\affil[2]{Econ-ARK}
\affil[3]{Reserve Bank of New Zealand}
\affil[4]{Japanese Ministry of Finance}
\affil[5]{Fannie Mae}

%%%%%%%%%%%%%%    Front matter    %%%%%%%%%%%%%%
\begin{document}

\twocolumn[\begin{@twocolumnfalse}

\maketitle

\begin{abstract}
This appendix provides detailed mathematical derivations and technical results supporting the Method of Moderation. Topics include: value function transformations and their relationship to the inverse value function; explicit formulas for minimal and maximal marginal propensities to consume; cusp point calculations for tighter upper bounds; Hermite interpolation slope formulas and MPC derivations; patience conditions ensuring well-defined solutions; and extensions to stochastic returns with explicit formulas for portfolio problems.\\
\end{abstract}

\keywords{Dynamic Stochastic Optimization, Numerical Methods}

\vspace{0.5cm}

\end{@twocolumnfalse}]

%%%%%%%%%%%%%%%  Main text   %%%%%%%%%%%%%%%

\section{Appendix: Mathematical Details}

\subsection{Patience Conditions Details}

The patience conditions listed in the main text have clear economic interpretations. The FVAC $0<\DiscFac\PermGroFac^{1 -\CRRA}\Ex[\permShk^{1 -\CRRA}]<1$ ensures autarky (consuming zero forever) has finite disutility, guaranteeing the consumer values resources. The AIC $\AbsPatFac<1$ prevents indefinite consumption deferral by ensuring the marginal utility of current consumption exceeds the discounted marginal utility of future consumption under certainty. The RIC $\AbsPatFac/\Rfree<1$ ensures asset growth is slower than the patience-adjusted discount rate, preventing unbounded wealth accumulation. The GIC $\AbsPatFac/\PermGroFac<1$ ensures consumption grows slower than permanent income, establishing a target wealth ratio. The FHWC $\PermGroFac/\Rfree<1$ ensures the present value of future labor income is finite. Together, these conditions partition parameter space into regions with qualitatively different behavior: buffer-stock saving with a target wealth ratio (all conditions hold), perpetual borrowing (AIC fails), or unbounded wealth growth (GIC fails but RIC holds) \citep{Carroll1997, SolvingMicroDSOPs, CarrollShanker2024}.

\subsection{Human Wealth Formulas}

The optimist's human wealth (assuming $\tranShk_{t+n}=1~\forall~n>0$) can be computed three ways: backward recursion $\hNrmOpt_{T} = 0$, $\hNrmOpt_{t} = (\PermGroFac/\Rfree)(1 + \hNrmOpt_{t+1})$; forward sum $\hNrmOpt_{t} = \sum_{n=1}^{T -t}(\PermGroFac/\Rfree)^{n}$; or infinite-horizon $\hNrmOpt = \PermGroFac/(\Rfree -\PermGroFac)$ when $\Rfree>\PermGroFac$. With $\PermGroFac=1$, $\hNrmOpt = 1/(\Rfree -1)$.

The pessimist's human wealth (assuming $\tranShk_{t+n}=\tranShkMin~\forall~n>0$) follows similarly: backward recursion $\hNrmPes_{T}=0$, $\hNrmPes_{t}=(\PermGroFac/\Rfree)(\tranShkMin + \hNrmPes_{t+1})$; forward sum $\hNrmPes_{t}=\tranShkMin\sum_{n=1}^{T -t}(\PermGroFac/\Rfree)^{n}$; or infinite-horizon $\hNrmPes=\tranShkMin\PermGroFac/(\Rfree -\PermGroFac)$. When $\tranShkMin=0$ (unemployment), $\hNrmPes=0$.

\subsection{Marginal Propensity to Consume Formulas}

The minimal MPC (perfect foresight consumer with horizon $T -t$) has three forms \citep{Carroll2001MPCBound}: backward recursion $\MPCmin_{t}=\MPCmin_{t+1}/(\MPCmin_{t+1}+\AbsPatFac/\Rfree)$ with $\MPCmin_T=1$; forward sum $\MPCmin_{t}=(\sum_{n=0}^{T -t}(\AbsPatFac/\Rfree)^{n})^{ -1}$; or infinite-horizon $\MPCmin=1 -\AbsPatFac/\Rfree = 1 -(\Rfree \DiscFac)^{1/\CRRA}/\Rfree$.

The maximal MPC \citep{CarrollToche2009} satisfies backward recursion $\MPCmax_{t} = 1 - \WorstProb^{1/\CRRA} (\AbsPatFac/\Rfree) (1 + \MPCmax_{t+1})$ with $\MPCmax_T = 1$; forward sum $\MPCmax_{t} = 1 - \WorstProb^{1/\CRRA} (\AbsPatFac/\Rfree) \sum_{n=0}^{T -t}\left(\WorstProb^{1/\CRRA} (\AbsPatFac/\Rfree)\right)^{n}$; or infinite-horizon $\MPCmax = 1 - \WorstProb^{1/\CRRA} (\AbsPatFac/\Rfree)$.

\subsection{Moderation Ratio Slope Formula}

The moderation ratio slope needed for Hermite interpolation is derived from differentiating (\ref{eq:modRte}) from the main text. Using the chain rule:

\begin{equation}
\label{eq:modRteMuDeriv}
\frac{\partial \modRte}{\partial \logmNrmEx} = \frac{\partial}{\partial \logmNrmEx}\left[\frac{\cFuncReal(\mNrmMin+e^{\logmNrmEx})-\cFuncPes(\mNrmMin+e^{\logmNrmEx})}{\hNrmEx \MPCmin}\right].
\end{equation}

Since $\partial e^{\logmNrmEx}/\partial \logmNrmEx = e^{\logmNrmEx} = \mNrmEx$ and $\cFuncPes$ is linear with slope $\MPCmin$, this yields

\begin{equation}
\label{eq:modRteMuFinal}
\frac{\partial \modRte}{\partial \logmNrmEx} = \frac{\mNrmEx (\partial \cFuncReal/\partial \mNrm - \MPCmin)}{\MPCmin \hNrmEx}.
\end{equation}

\subsection{Asymptotic Linearity and Extrapolation}

Under the GIC, the logit-transformed moderation ratio $\logitModRte(\logmNrmEx)$ is asymptotically linear with slope $\asympSlope = \lim_{\logmNrmEx \to +\infty} \frac{\partial \logitModRte}{\partial \logmNrmEx} \geq 0$ as $\logmNrmEx \to +\infty$. This slope may equal zero in theory, but is strictly positive on finite grids. For practical implementation, extrapolate $\logitModRte$ linearly using the positive boundary slope computed at the highest gridpoint. This linear extrapolation preserves $\modRte\in(0,1)$ and hence $\cFuncPes < \cFuncApprox < \cFuncOpt$ throughout the extrapolation domain, even if the theoretical limiting slope vanishes. The asymptotic linearity property is crucial because it allows the method to accurately represent the consumption function far beyond the range of gridpoints where the Euler equation was solved, without ever violating the theoretical bounds.

\subsection{Cusp Point Calculation}

The two upper bounds intersect at the cusp point $\mNrmCusp$ where

\begin{equation}
\label{eq:mNrmCuspFull}
\begin{array}{rclcll}
\bigl(\mNrmCuspEx + \hNrmEx\bigr)\,\MPCmin &= & \MPCmax\,\mNrmCuspEx & & \\
\mNrmCuspEx &= & \dfrac{\MPCmin\,\hNrmEx}{\MPCmax-\MPCmin} & & \\
\mNrmCusp &= & -\hNrmPes + \dfrac{\MPCmin\,\bigl(\hNrmOpt-\hNrmPes\bigr)}{\MPCmax-\MPCmin},
\end{array}
\end{equation}

where $\mNrmCuspEx\equiv\mNrmCusp -\mNrmMin > 0$ since $\MPCmax > \MPCmin$. For $\mNrm \in (\mNrmMin, \mNrmCusp]$, the tighter upper bound yields

\begin{equation}
\begin{array}{rcl}
\mNrmEx \MPCmin < & \cFuncReal(\mNrmMin+\mNrmEx) & < \MPCmax \mNrmEx \\
0 < & \cFuncReal(\mNrmMin+\mNrmEx) - \mNrmEx \MPCmin & < \mNrmEx(\MPCmax- \MPCmin) \\
0 < & \left(\frac{\cFuncReal(\mNrmMin+\mNrmEx) - \mNrmEx \MPCmin}{\mNrmEx(\MPCmax- \MPCmin)}\right) & < 1.
\end{array}
\end{equation}

We define the low-region moderation ratio as

\begin{equation}
\modRteLoTightUpBd(\logmNrmEx) = \frac{\cFuncReal(\mNrmMin+e^{\logmNrmEx})e^{-\logmNrmEx}-\MPCmin}{\MPCmax-\MPCmin},
\end{equation}

which measures how far consumption per unit of wealth exceeds the pessimist's MPC ($\MPCmin$) relative to the maximum possible excess ($\MPCmax - \MPCmin$).

\subsection{Value Function Derivation}

Under perfect foresight, consumption grows at constant rate $\AbsPatFac$: $\cLvl_{t+n}=\cLvl_{t}\AbsPatFac^{n}$. The present discounted value of consumption satisfies $\PDV_{t}^{T}(\cLvl)=\sum_{n=0}^{T -t}\DiscFac^{n}\cLvl_{t}\AbsPatFac^{n}=\cLvl_{t}\sum_{n=0}^{T -t}(\AbsPatFac/\Rfree)^{n}$, where we use $\DiscFac\AbsPatFac^{1 -\CRRA}=\AbsPatFac/\Rfree$. Dividing by consumption yields the PDV-to-consumption ratio $\PDVCoverc_{t}^{T}=\PDV_{t}^{T}(\cLvl)/\cLvl_{t}=\sum_{n=0}^{T -t}(\AbsPatFac/\Rfree)^{n}=\MPCmin_{t}^{ -1}$, which is unchanged for normalized variables. This yields the key identity $\PDVCoverc = \MPCmin^{ -1}$ in the infinite-horizon limit, connecting the PDV-to-consumption ratio to the minimal MPC.

The optimist's value function satisfies

\begin{equation}
\begin{aligned}
\vFuncOpt_{T-1}(\mNrm_{T-1}) &\equiv  \uFunc(\cNrm_{T-1})+\DiscFac \uFunc(\cNrm_{T}) \\
&= \uFunc(\cNrm_{T-1})\left(1+\DiscFac \AbsPatFac^{1-\CRRA}\right) \\
&= \uFunc(\cNrm_{T-1})\left(1+\AbsPatFac/\Rfree\right) \\
&= \uFunc(\cNrm_{T-1})\PDVCoverc_{T-1}^{T}
\end{aligned}
\end{equation}

The general expression becomes

\begin{equation}
\label{eq:vFuncPF}
\begin{aligned}
\vFuncOpt(\mNrm) &= \uFunc(\cFuncOpt(\mNrm))\PDVCoverc \\
&= \uFunc(\cFuncOpt(\mNrm))\MPCmin^{-1} \\
&= \uFunc((\mNrmEx+\hNrmEx)\MPCmin) \MPCmin^{-1} \\
&= \left[(\mNrmEx+\hNrmEx)^{1-\CRRA}/(1-\CRRA)\right] \cdot \left[\MPCmin^{1-\CRRA} \cdot \MPCmin^{-1}\right] \\
&= \uFunc(\mNrmEx+\hNrmEx)\MPCmin^{-\CRRA}.
\end{aligned}
\end{equation}

This can be transformed as

\begin{equation}
\begin{aligned}
\vInvOpt &\equiv  \left((1-\CRRA)\vFuncOpt\right)^{1/(1-\CRRA)}   \\
&= \cNrm\,\PDVCoverc^{1/(1-\CRRA)} \\
&= (\mNrmEx+\hNrmEx)\MPCmin^{-\CRRA/(1-\CRRA)}.
\end{aligned}
\end{equation}

For the realist's problem, we define $\vInvReal = \left((1 -\CRRA)\vFuncReal(\mNrm)\right)^{1/(1 -\CRRA)}$. Using the bounds $\vInvPes < \vInvReal < \vInvOpt$, we define

\begin{equation}
\label{eq:valModRteReal}
\valModRteReal(\logmNrmEx) = \left(\frac{\vInvReal(\mNrmMin+e^{\logmNrmEx})-\vInvPes(\mNrmMin+e^{\logmNrmEx})}{\hNrmEx \MPCmin \,\PDVCoverc^{1/(1-\CRRA)}}\right)
\end{equation}

and:

\begin{equation}
\label{eq:ChiUpper}
\begin{aligned}
\logitValModRteReal(\logmNrmEx) &= \log \left(\frac{\valModRteReal(\logmNrmEx)}{1-\valModRteReal(\logmNrmEx)}\right) \\
&= \log(\valModRteReal(\logmNrmEx)) - \log(1-\valModRteReal(\logmNrmEx))
\end{aligned}
\end{equation}

Inverting these approximations yields

\begin{equation}
\label{eq:vInvHi}
\vInvReal = \vInvPes+\overbrace{\left(\frac{1}{1+\exp(-\logitValModRteReal)}\right)}^{=\valModRteReal} \hNrmEx \MPCmin \,\PDVCoverc^{1/(1-\CRRA) }
\end{equation}

from which the value function approximation is $\vFuncReal = \uFunc(\vInvReal)$.

\subsection{Hermite Interpolation: Slope Derivations}

The logit transformation slope follows from the chain rule \citep{Santos2000, JuddMaliarMaliar2017}:

\begin{equation}
\label{eq:logitModRteMu}
\frac{\partial \logitModRte}{\partial \logmNrmEx} = \frac{\partial}{\partial \logmNrmEx}\left[\log\modRte - \log(1-\modRte)\right] = \frac{\modRteMu}{\modRte(1 - \modRte)}
\end{equation}

where $\modRteMu$ is from (\ref{eq:modRteMuFinal}). For monotone cubic Hermite schemes \citep{Fritsch1980, FritschButland1984, deBoor2001}, theoretical slopes may be adjusted to enforce monotonicity \citep{Hyman1983}. The Fritsch-Carlson algorithm modifies slopes at local extrema, while Fritsch-Butland uses harmonic mean weighting. Both preserve the shape-preserving property essential for consumption functions that must be strictly increasing.

The MPC weight derivation starts from differentiating (\ref{eq:cFuncHi}) from the main text with respect to $\mNrm$:

\begin{equation}
\frac{\partial \cFuncReal}{\partial \mNrm} = \frac{\partial \cFuncPes}{\partial \mNrm} + \frac{\partial}{\partial \mNrm}\left[\modRte \hNrmEx \MPCmin\right].
\end{equation}

Since $\cFuncPes$ has constant MPC and $\hNrmEx$ is constant, $\partial \cFuncPes/\partial \mNrm = \MPCmin$ and $\partial \modRte/\partial \mNrm = (\partial \modRte/\partial \logmNrmEx) \cdot (\partial \logmNrmEx/\partial \mNrmEx) \cdot (\partial \mNrmEx/\partial \mNrm) = \modRteMu \cdot (1/\mNrmEx) \cdot 1$. This yields

\begin{equation}
\frac{\partial \cFuncReal}{\partial \mNrm} = \MPCmin + \frac{\modRteMu \hNrmEx \MPCmin}{\mNrmEx} = \MPCmin\left(1 + \frac{\hNrmEx}{\mNrmEx}\modRteMu\right).
\end{equation}

Factoring as a weighted average between $\MPCmin$ and $\MPCmax$ gives (\ref{eq:MPCModeration}) from the main text, with weight

\begin{equation}
\MPCmod = \frac{\MPCmin}{\MPCmax-\MPCmin} \cdot \frac{\hNrmEx}{\mNrmEx} \cdot \modRteMu.
\end{equation}

\subsection{Stochastic Returns: MGF Derivation}

The moment generating function (MGF) for lognormal returns provides the key formula. For $\log \Risky \sim \Nrml(\mu, \sigma^2)$, the MGF is $\Ex[e^{sX}] = \exp(\mu s + \sigma^2 s^2/2)$ where $X = \log \Risky$. Setting $s = 1 -\CRRA$ and $\mu = r + \equityPrem - \std_{\risky}^2/2$ yields

\begin{equation}
\Ex[\Risky^{1-\CRRA}] = \exp\left((1-\CRRA)\left(r+\equityPrem - \frac{\std_{\risky}^2}{2}\right) + \frac{(1-\CRRA)^2\std_{\risky}^2}{2}\right).
\end{equation}

Simplifying the variance terms: $(1 -\CRRA)^2\std_{\risky}^2/2 - (1 -\CRRA)\std_{\risky}^2/2 = (1 -\CRRA)[(1 -\CRRA) -1]\std_{\risky}^2/2 = (1 -\CRRA)( -\CRRA)\std_{\risky}^2/2$, giving the final form

\begin{equation}
\Ex[\Risky^{1-\CRRA}] = \exp((1-\CRRA)(r+\equityPrem) + (1-\CRRA)(1-2\CRRA)\std_{\risky}^2/2).
\end{equation}

For serially correlated returns, the return state becomes an additional state variable, requiring two-dimensional interpolation of the moderation ratio.

\subsection{Shock Discretization}

Continuous shock distributions require discretization. The Tauchen method \citep{tauchen1986} constructs a Markov chain by dividing the state space into bins. The Tauchen-Hussey method \citep{TauchenHussey1991} uses Gaussian quadrature, often requiring fewer states for comparable accuracy. For unemployment shocks, assign probability $\WorstProb$ to zero income and $(1 -\WorstProb)$ across positive realizations. Choose gridpoints and shock points via convergence analysis. The method of moderation is efficient because the transformed moderation ratio is better-behaved than consumption, requiring fewer gridpoints.



%%%%%%%%%%%%%%   Bibliography   %%%%%%%%%%%%%%
\bibliography{main.bib}

\end{document}
